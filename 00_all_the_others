dimension: updated_or_created {
  hidden: yes
  type: yesno
  sql:
    (
      DATE(${updated_raw}) >= DATE_TRUNC(CURRENT_DATE(), MONTH)
      OR DATE(${start_raw}) >= DATE_TRUNC(CURRENT_DATE(), MONTH)
    ) ;;
  description: "TRUE if the case was either updated or created during the current month."
}

measure: total_cases_managed_this_month_touched_any {
  label: "Cases Managed (Touched or Created – This Month)"
  group_label: "Data – Case Worker"
  type: count_distinct
  sql: ${id} ;;
  filters: [updated_or_created: "yes"]
  value_format_name: decimal_0
  description: "Counts all unique cases that were updated or newly created during the current month — representing every case actively managed."
}


dimension: updated_or_created_this_year {
  hidden: yes
  type: yesno
  sql:
    (
      EXTRACT(YEAR FROM DATE(${updated_raw})) = EXTRACT(YEAR FROM CURRENT_DATE())
      OR EXTRACT(YEAR FROM DATE(${start_raw})) = EXTRACT(YEAR FROM CURRENT_DATE())
    ) ;;
  description: "TRUE if the case was either updated or created during the current year."
}

measure: total_cases_managed_this_year_touched_any {
  label: "Cases Managed (Touched or Created – This Year)"
  group_label: "Data – Case Worker"
  type: count_distinct
  sql: ${id} ;;
  filters: [updated_or_created_this_year: "yes"]
  value_format_name: decimal_0
}